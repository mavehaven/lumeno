<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Understanding Integrals: A Comprehensive Guide</title>
  <!-- MathJS for calculations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
  <!-- MathJax for rendering LaTeX -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f8f9fa;
      line-height: 1.6;
      color: #333;
    }
    h1, h2, h3 {
      text-align: center;
      color: #2c3e50;
    }
    h1 {
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }
    .section {
      background-color: #fff;
      padding: 25px;
      margin-bottom: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .explanation {
      background: #f8f9fa;
      padding: 15px;
      border-left: 4px solid #3498db;
      margin: 15px 0;
      border-radius: 0 8px 8px 0;
    }
    .real-world {
      background: #e8f4fd;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    .real-world h4 {
      color: #2980b9;
      margin-top: 0;
    }
    .step-by-step {
      background: #fff5e6;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    .step-by-step h4 {
      color: #e67e22;
      margin-top: 0;
    }
    .formula {
      text-align: center;
      font-size: 1.2em;
      margin: 15px 0;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    .canvas-container {
      margin: 20px 0;
      text-align: center;
      position: relative;
    }
    canvas {
      border: 1px solid #ddd;
      background: #fff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .controls {
      margin: 15px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
    }
    .calculations {
      margin: 15px 0;
      padding: 15px;
      background: #e9ecef;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 1.1em;
    }
    button {
      padding: 10px 18px;
      margin: 0 5px;
      background: #3498db;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }
    button:hover {
      background: #2980b9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .slider {
      width: 200px;
      margin: 10px;
    }
    .concept {
      display: none;
    }
    .concept.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .navigation {
      text-align: center;
      margin: 25px 0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    .navigation button {
      background: #2c3e50;
    }
    .navigation button:hover {
      background: #1a252f;
    }
    .progress-bar {
      height: 5px;
      background: #e0e0e0;
      border-radius: 5px;
      margin: 10px 0;
      overflow: hidden;
    }
    .progress {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.5s ease;
    }
    .tooltip {
      position: relative;
      display: inline-block;
      border-bottom: 1px dotted #3498db;
      cursor: help;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: #2c3e50;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    .comparison-table th, .comparison-table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    .comparison-table th {
      background-color: #3498db;
      color: white;
    }
    .comparison-table tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    input[type="text"] {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1em;
    }
    select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1em;
    }
    .fundamental-theorem {
      background: #e8f8f5;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    .fundamental-theorem h4 {
      color: #16a085;
      margin-top: 0;
    }
  </style>
</head>
<body>
  <h1>Understanding Integrals: From Areas to Antiderivatives</h1>
  <p style="text-align: center; font-size: 1.1em;">A comprehensive guide exploring the concepts from basic area calculations to integration techniques with interactive examples, real-world applications, and step-by-step explanations.</p>
  
  <div class="progress-bar">
    <div class="progress" id="progressBar"></div>
  </div>
  
  <div class="navigation">
    <button onclick="showConcept('introduction')">Introduction</button>
    <button onclick="showConcept('area')">Area Under Curve</button>
    <button onclick="showConcept('riemann')">Riemann Sums</button>
    <button onclick="showConcept('definite')">Definite Integrals</button>
    <button onclick="showConcept('indefinite')">Indefinite Integrals</button>
    <button onclick="showConcept('fundamental')">Fundamental Theorem</button>
    <button onclick="showConcept('applications')">Applications</button>
    <button onclick="showConcept('practice')">Practice Problems</button>
  </div>

  <!-- Introduction Section -->
  <div id="introduction" class="concept section active">
    <h2>Introduction to Integrals</h2>
    <p>Integration is the mathematical process of finding the whole from its parts. In calculus, it's used to find areas, volumes, central points, and many other useful things.</p>
    
    <div class="explanation">
      <h3>Why Study Integrals?</h3>
      <p>Integrals help us understand:</p>
      <ul>
        <li>How to calculate areas under curves and volumes of complex shapes</li>
        <li>How to determine accumulated quantities over time</li>
        <li>The relationship between a function and its rate of change</li>
        <li>Solutions to differential equations that model real-world phenomena</li>
      </ul>
    </div>
    
    <div class="real-world">
      <h4>Real-World Applications</h4>
      <p>Integrals are used in:</p>
      <ul>
        <li><strong>Physics:</strong> Calculating work, energy, and center of mass</li>
        <li><strong>Engineering:</strong> Determining stress distribution, fluid flow, and electrical fields</li>
        <li><strong>Economics:</strong> Finding consumer and producer surplus</li>
        <li><strong>Medicine:</strong> Modeling drug concentration over time</li>
        <li><strong>Statistics:</strong> Calculating probabilities using probability density functions</li>
      </ul>
    </div>
    
    <div class="step-by-step">
      <h4>What You'll Learn</h4>
      <p>This tutorial will guide you through:</p>
      <ol>
        <li>Understanding the concept of area under a curve</li>
        <li>Approximating areas using Riemann sums</li>
        <li>Calculating definite integrals exactly</li>
        <li>Finding antiderivatives (indefinite integrals)</li>
        <li>Applying the Fundamental Theorem of Calculus</li>
        <li>Using integrals to solve real-world problems</li>
      </ol>
    </div>
    
    <div class="formula">
      The definite integral of a function \( f(x) \) from \( a \) to \( b \) is defined as:
      \[ \int_{a}^{b} f(x)\,dx = \lim_{n \to \infty} \sum_{i=1}^{n} f(x_i^*) \Delta x \]
    </div>
  </div>

  <!-- AREA UNDER CURVE SECTION -->
  <div id="area" class="concept section">
    <h2>1. Area Under a Curve</h2>
    <p>
      The area under a curve represents the accumulation of a quantity. For a function \( f(x) \) that is non-negative on \([a, b]\), the definite integral \( \int_{a}^{b} f(x)\,dx \) gives the area between the curve and the x-axis.
    </p>
    
    <div class="formula">
      \[ \text{Area} = \int_{a}^{b} f(x)\,dx \]
    </div>
    
    <div class="explanation">
      <h3>Interpreting Area Under Curves</h3>
      <ul>
        <li>For velocity-time graphs, area represents displacement</li>
        <li>For acceleration-time graphs, area represents change in velocity</li>
        <li>For marginal cost functions, area represents total cost</li>
        <li>For probability density functions, area represents probability</li>
      </ul>
    </div>
    
    <div class="controls">
      <label>Select function: </label>
      <select id="functionSelect">
        <option value="linear">Linear \(y=x\)</option>
        <option value="quadratic">Quadratic \(y=\frac{x^2}{2}\)</option>
        <option value="sine">Sine \(y=\sin x\)</option>
        <option value="exponential">Exponential \(y=e^x\)</option>
        <option value="constant">Constant \(y=2\)</option>
      </select>
      <label>Lower bound: </label>
      <input type="range" min="-5" max="5" step="0.1" value="0" class="slider" id="lowerAreaSlider">
      <span id="lowerAreaValue">0</span>
      <label>Upper bound: </label>
      <input type="range" min="-5" max="5" step="0.1" value="2" class="slider" id="upperAreaSlider">
      <span id="upperAreaValue">2</span>
      <button onclick="toggleNegativeArea()">Show Negative Areas</button>
    </div>
    
    <div class="calculations" id="areaCalculations">
      <div>Range: [<span id="lowerAreaBound">0</span>, <span id="upperAreaBound">2</span>]</div>
      <div>Area: <span id="areaValue">0</span></div>
      <div id="negativeAreaInfo" style="display: none;">Negative area (below x-axis): <span id="negativeAreaValue">0</span></div>
    </div>
    
    <div class="canvas-container">
      <canvas id="areaCanvas" width="500" height="350"></canvas>
    </div>
    
    <div class="step-by-step">
      <h4>Step-by-Step: Calculating Area</h4>
      <ol>
        <li>Identify the function \( f(x) \) and the interval \([a, b]\)</li>
        <li>Determine if the function is non-negative on the interval</li>
        <li>If the function crosses the x-axis, split the integral at the crossing points</li>
        <li>Calculate the definite integral using antiderivatives</li>
        <li>For areas, take the absolute value of integrals where the function is negative</li>
      </ol>
    </div>
    
    <div class="real-world">
      <h4>Real-World Example: Distance Traveled</h4>
      <p>If this graph represented velocity over time, the area under the curve would represent the total distance traveled during that time interval.</p>
    </div>
  </div>

  <!-- RIEMANN SUMS SECTION -->
  <div id="riemann" class="concept section">
    <h2>2. Riemann Sums</h2>
    <p>
      Riemann sums approximate the area under a curve by dividing the region into rectangles and summing their areas. As the number of rectangles increases, the approximation improves.
    </p>
    
    <div class="formula">
      \[ \text{Riemann Sum} = \sum_{i=1}^{n} f(x_i^*) \Delta x \]
    </div>
    
    <div class="explanation">
      <h3>Types of Riemann Sums</h3>
      <ul>
        <li><strong>Left Riemann Sum:</strong> Uses the left endpoint of each subinterval</li>
        <li><strong>Right Riemann Sum:</strong> Uses the right endpoint of each subinterval</li>
        <li><strong>Midpoint Riemann Sum:</strong> Uses the midpoint of each subinterval</li>
        <li><strong>Trapezoidal Rule:</strong> Uses trapezoids instead of rectangles for better accuracy</li>
      </ul>
    </div>
    
    <div class="controls">
      <label>Number of rectangles: </label>
      <input type="range" min="1" max="100" value="5" class="slider" id="rectCountSlider">
      <span id="rectCountValue">5</span>
      <select id="riemannType">
        <option value="left">Left Riemann Sum</option>
        <option value="right">Right Riemann Sum</option>
        <option value="middle">Middle Riemann Sum</option>
        <option value="trapezoidal">Trapezoidal Rule</option>
      </select>
      <button onclick="animateRiemannConvergence()">Animate Convergence</button>
    </div>
    
    <div class="calculations" id="riemannCalculations">
      <div>Rectangle count: <span id="rectCount">5</span></div>
      <div>Approximation: <span id="riemannValue">0</span></div>
      <div>Actual area: <span id="actualArea">0</span></div>
      <div>Error: <span id="errorValue">0</span></div>
      <div>Percentage error: <span id="percentageError">0</span>%</div>
    </div>
    
    <div class="canvas-container">
      <canvas id="riemannCanvas" width="500" height="350"></canvas>
    </div>
    
    <div class="step-by-step">
      <h4>Step-by-Step: Riemann Sum Calculation</h4>
      <ol>
        <li>Divide the interval \([a, b]\) into \(n\) equal subintervals</li>
        <li>Calculate the width of each subinterval: \(\Delta x = \frac{b-a}{n}\)</li>
        <li>Determine the sample points \(x_i^*\) based on the type of Riemann sum</li>
        <li>Evaluate the function at each sample point: \(f(x_i^*)\)</li>
        <li>Multiply each function value by \(\Delta x\) and sum the results</li>
      </ol>
    </div>
  </div>

  <!-- DEFINITE INTEGRALS SECTION -->
  <div id="definite" class="concept section">
    <h2>3. Definite Integrals</h2>
    <p>
      A definite integral \( \int_{a}^{b} f(x)\,dx \) computes the exact net area under \( f(x) \) from \(x=a\) to \(x=b\). This represents the accumulation of the quantity described by the function over the interval.
    </p>
    
    <div class="formula">
      \[ \int_{a}^{b} f(x)\,dx = F(b) - F(a) \]
      where \( F(x) \) is an antiderivative of \( f(x) \)
    </div>
    
    <div class="explanation">
      <h3>Properties of Definite Integrals</h3>
      <ul>
        <li>\(\int_{a}^{b} f(x)\,dx = -\int_{b}^{a} f(x)\,dx\) (Reversal of limits)</li>
        <li>\(\int_{a}^{a} f(x)\,dx = 0\) (Same limits)</li>
        <li>\(\int_{a}^{b} [f(x) + g(x)]\,dx = \int_{a}^{b} f(x)\,dx + \int_{a}^{b} g(x)\,dx\) (Additivity)</li>
        <li>\(\int_{a}^{b} cf(x)\,dx = c\int_{a}^{b} f(x)\,dx\) (Constant multiple)</li>
        <li>\(\int_{a}^{b} f(x)\,dx = \int_{a}^{c} f(x)\,dx + \int_{c}^{b} f(x)\,dx\) (Splitting intervals)</li>
      </ul>
    </div>
    
    <div class="controls">
      <label>Select function: </label>
      <select id="definiteFunctionSelect">
        <option value="linear">Linear \(y=x\)</option>
        <option value="quadratic">Quadratic \(y=x^2\)</option>
        <option value="sine">Sine \(y=\sin x\)</option>
        <option value="exponential">Exponential \(y=e^x\)</option>
      </select>
      <label>Lower bound: </label>
      <input type="range" min="-5" max="5" value="0" step="0.1" class="slider" id="lowerBoundSlider">
      <span id="lowerBoundValue">0</span>
      <label>Upper bound: </label>
      <input type="range" min="-5" max="5" value="2" step="0.1" class="slider" id="upperBoundSlider">
      <span id="upperBoundValue">2</span>
      <button onclick="animateIntegration()">Animate Integration</button>
      <button onclick="showAccumulationFunction()">Show Accumulation Function</button>
    </div>
    
    <div class="calculations" id="definiteCalculations">
      <div>Bounds: [<span id="lowerBound">0</span>, <span id="upperBound">2</span>]</div>
      <div>Integral value: <span id="integralValue">0</span></div>
      <div>Antiderivative: <span id="antiderivativeDisplay">\( \frac{x^2}{2} \)</span></div>
      <div>Evaluation: <span id="evaluationDisplay">\( F(b) - F(a) = 2 - 0 = 2 \)</span></div>
    </div>
    
    <div class="canvas-container">
      <canvas id="definiteCanvas" width="500" height="350"></canvas>
    </div>
    
    <div class="step-by-step">
      <h4>Step-by-Step: Evaluating Definite Integrals</h4>
      <ol>
        <li>Find an antiderivative \( F(x) \) of \( f(x) \)</li>
        <li>Evaluate \( F(x) \) at the upper limit: \( F(b) \)</li>
        <li>Evaluate \( F(x) \) at the lower limit: \( F(a) \)</li>
        <li>Subtract: \( F(b) - F(a) \)</li>
      </ol>
    </div>
  </div>

  <!-- INDEFINITE INTEGRALS SECTION -->
  <div id="indefinite" class="concept section">
    <h2>4. Indefinite Integrals (Antiderivatives)</h2>
    <p>
      An indefinite integral, or antiderivative, of a function \( f(x) \) is a function \( F(x) \) such that \( F'(x) = f(x) \). The indefinite integral represents a family of functions that differ by a constant.
    </p>
    
    <div class="formula">
      \[ \int f(x)\,dx = F(x) + C \]
    </div>
    
    <div class="explanation">
      <h3>Common Integration Rules</h3>
      <table class="comparison-table">
        <tr>
          <th>Function</th>
          <th>Antiderivative</th>
        </tr>
        <tr>
          <td>\( x^n \) (n ≠ -1)</td>
          <td>\( \frac{x^{n+1}}{n+1} + C \)</td>
        </tr>
        <tr>
          <td>\( \frac{1}{x} \)</td>
          <td>\( \ln|x| + C \)</td>
        </tr>
        <tr>
          <td>\( e^x \)</td>
          <td>\( e^x + C \)</td>
        </tr>
        <tr>
          <td>\( \sin x \)</td>
          <td>\( -\cos x + C \)</td>
        </tr>
        <tr>
          <td>\( \cos x \)</td>
          <td>\( \sin x + C \)</td>
        </tr>
      </table>
    </div>
    
    <div class="controls">
      <label>Select function: </label>
      <select id="indefiniteSelect">
        <option value="constant">Constant \(2\)</option>
        <option value="linear">Linear \(2x\)</option>
        <option value="quadratic">Quadratic \(x^2\)</option>
        <option value="sine">Sine \( \sin x \)</option>
        <option value="exponential">Exponential \( e^x \)</option>
        <option value="reciprocal">Reciprocal \( \frac{1}{x} \)</option>
      </select>
      <button onclick="showAntiderivative()">Show Antiderivative</button>
      <button onclick="showFamilyOfCurves()">Show Family of Curves</button>
    </div>
    
    <div class="calculations" id="indefiniteCalculations">
      <div>Original function: <span id="originalFunction">\(2\)</span></div>
      <div>Antiderivative: <span id="antiderivative">\(2x + C\)</span></div>
    </div>
    
    <div class="canvas-container">
      <canvas id="indefiniteCanvas" width="500" height="350"></canvas>
    </div>
    
    <div class="step-by-step">
      <h4>Step-by-Step: Finding Antiderivatives</h4>
      <ol>
        <li>Identify the function to integrate</li>
        <li>Apply the appropriate integration rule</li>
        <li>Add the constant of integration \( C \)</li>
        <li>If given an initial condition, solve for \( C \)</li>
      </ol>
    </div>
    
    <div class="real-world">
      <h4>Real-World Example: Position from Velocity</h4>
      <p>If this graph represented velocity over time, the antiderivative would represent the position function. The constant \( C \) represents the initial position.</p>
    </div>
  </div>

  <!-- FUNDAMENTAL THEOREM OF CALCULUS SECTION -->
  <div id="fundamental" class="concept section">
    <h2>5. Fundamental Theorem of Calculus</h2>
    <p>
      The Fundamental Theorem of Calculus connects differentiation and integration, showing that these two operations are essentially inverses of each other.
    </p>
    
    <div class="fundamental-theorem">
      <h4>Part 1: Derivative of an Integral</h4>
      <p>If \( f \) is continuous on \([a, b]\) and \( F(x) = \int_{a}^{x} f(t)\,dt \), then \( F \) is differentiable on \((a, b)\) and \( F'(x) = f(x) \).</p>
      
      <div class="formula">
        \[ \frac{d}{dx} \left[ \int_{a}^{x} f(t)\,dt \right] = f(x) \]
      </div>
      
      <h4>Part 2: Evaluation Theorem</h4>
      <p>If \( f \) is continuous on \([a, b]\) and \( F \) is any antiderivative of \( f \), then:</p>
      
      <div class="formula">
        \[ \int_{a}^{b} f(x)\,dx = F(b) - F(a) \]
      </div>
    </div>
    
    <div class="controls">
      <label>Select function: </label>
      <select id="ftcFunctionSelect">
        <option value="linear">Linear \(y=x\)</option>
        <option value="quadratic">Quadratic \(y=x^2\)</option>
        <option value="sine">Sine \(y=\sin x\)</option>
      </select>
      <label>Lower bound (a): </label>
      <input type="range" min="-5" max="5" value="0" step="0.1" class="slider" id="ftcLowerSlider">
      <span id="ftcLowerValue">0</span>
      <label>Upper bound (x): </label>
      <input type="range" min="-5" max="5" value="2" step="0.1" class="slider" id="ftcUpperSlider">
      <span id="ftcUpperValue">2</span>
      <button onclick="demonstrateFTC()">Demonstrate FTC</button>
    </div>
    
    <div class="calculations" id="ftcCalculations">
      <div>Accumulation function: \( F(x) = \int_{<span id="ftcLowerBound">0</span>}^{x} f(t)\,dt \)</div>
      <div>Derivative of F(x): \( F'(x) = <span id="ftcDerivative">f(x)</span> \)</div>
      <div>Value of F(x) at x = <span id="currentX">2</span>: <span id="ftcValue">2</span></div>
      <div>Value of f(x) at x = <span id="currentX2">2</span>: <span id="functionValue">2</span></div>
    </div>
    
    <div class="canvas-container">
      <canvas id="ftcCanvas" width="500" height="350"></canvas>
    </div>
    
    <div class="explanation">
      <h3>Why the Fundamental Theorem Matters</h3>
      <p>The Fundamental Theorem of Calculus is important because:</p>
      <ul>
        <li>It provides a method to evaluate definite integrals without using limits of Riemann sums</li>
        <li>It establishes the inverse relationship between differentiation and integration</li>
        <li>It allows us to solve differential equations by integration</li>
        <li>It forms the theoretical foundation for many applications in physics and engineering</li>
      </ul>
    </div>
  </div>

  <!-- APPLICATIONS SECTION -->
  <div id="applications" class="concept section">
    <h2>6. Applications of Integrals</h2>
    <p>Integrals have numerous practical applications across various fields. Let's explore some key applications.</p>
    
    <div class="explanation">
      <h3>Area Between Curves</h3>
      <p>The area between two curves \( f(x) \) and \( g(x) \) from \( x = a \) to \( x = b \) is given by:</p>
      
      <div class="formula">
        \[ \text{Area} = \int_{a}^{b} |f(x) - g(x)|\,dx \]
      </div>
      
      <div class="controls">
        <label>Select curves: </label>
        <select id="areaBetweenSelect" onchange="showAreaBetweenCurves()">
          <option value="linear_quadratic">Linear and Quadratic</option>
          <option value="sine_cosine">Sine and Cosine</option>
          <option value="exponential_linear">Exponential and Linear</option>
        </select>
      </div>
      
      <div class="canvas-container">
        <canvas id="areaBetweenCanvas" width="500" height="350"></canvas>
      </div>
    </div>
    
    <div class="real-world">
      <h3>Volumes of Revolution</h3>
      <p>Integrals can be used to find volumes of solids formed by rotating a region about an axis.</p>
      
      <div class="formula">
        Disk Method: \( V = \pi \int_{a}^{b} [f(x)]^2\,dx \)
      </div>
      
      <div class="controls">
        <label>Select function and axis: </label>
        <select id="volumeSelect" onchange="showVolumeOfRevolution()">
          <option value="quadratic_x">Quadratic about x-axis</option>
          <option value="sine_x">Sine about x-axis</option>
          <option value="linear_y">Linear about y-axis</option>
        </select>
      </div>
      
      <div class="canvas-container">
        <canvas id="volumeCanvas" width="500" height="350"></canvas>
      </div>
    </div>
    
    <div class="step-by-step">
      <h3>Work and Fluid Pressure</h3>
      <p>In physics, integrals are used to calculate work done by variable forces and fluid pressure on surfaces.</p>
      
      <div class="controls">
        <label>Select application: </label>
        <select id="physicsSelect" onchange="showPhysicsApplication()">
          <option value="spring">Spring Work</option>
          <option value="pumping">Pumping Liquid</option>
          <option value="fluid_pressure">Fluid Pressure</option>
        </select>
      </div>
      
      <div id="physicsApplication" class="calculations">
        <p><strong>Spring Work:</strong> The work required to stretch a spring from position a to b is \( W = \int_{a}^{b} kx\,dx \), where k is the spring constant.</p>
        <p><strong>Example:</strong> If k = 5 N/m, work to stretch from 0 to 2 m is \( \int_{0}^{2} 5x\,dx = \left[ \frac{5x^2}{2} \right]_0^2 = 10 \) Joules.</p>
      </div>
    </div>
  </div>

  <!-- PRACTICE PROBLEMS SECTION -->
  <div id="practice" class="concept section">
    <h2>7. Practice Problems</h2>
    <p>Test your understanding with these practice problems. Try to solve them on your own before checking the solution!</p>
    
    <div class="controls">
      <button onclick="changeProblemType('area')">Area Problems</button>
      <button onclick="changeProblemType('riemann')">Riemann Sums</button>
      <button onclick="changeProblemType('definite')">Definite Integrals</button>
      <button onclick="changeProblemType('indefinite')">Indefinite Integrals</button>
      <button onclick="changeProblemType('applications')">Applications</button>
    </div>
    
    <div class="section" id="problemContainer">
      <h3 id="problemTitle">Area Under Curve Problems</h3>
      <div id="currentProblem" class="calculations"></div>
      <div class="controls">
        <input type="text" id="userAnswer" placeholder="Enter your answer">
        <button onclick="checkAnswer()">Check Answer</button>
        <button onclick="showSolution()">Show Solution</button>
        <button onclick="nextProblem()">Next Problem</button>
        <button onclick="hint()">Hint</button>
      </div>
      <div id="hint" class="calculations" style="display: none;"></div>
      <div id="feedback" class="calculations" style="display: none;"></div>
      <div id="solution" class="calculations" style="display: none;"></div>
    </div>
    
    <div class="real-world">
      <h3>Challenge Problems</h3>
      <p>For those who want an extra challenge:</p>
      <div id="challengeProblems" class="calculations">
        <p><strong>1.</strong> Evaluate \( \int_{0}^{\pi} x\sin(x)\,dx \)</p>
        <p><strong>2.</strong> Find the volume of the solid formed by rotating the region bounded by \( y = \sqrt{x} \), \( y = 0 \), and \( x = 4 \) about the x-axis.</p>
        <p><strong>3.</strong> A spring has a natural length of 10 cm. A 20 N force is required to stretch it to 15 cm. How much work is done in stretching it from 15 cm to 20 cm?</p>
      </div>
    </div>
  </div>

  <script>
    // Update progress bar based on current section
    const sections = ['introduction', 'area', 'riemann', 'definite', 'indefinite', 'fundamental', 'applications', 'practice'];
    
    function updateProgressBar() {
      const currentSection = document.querySelector('.concept.active').id;
      const currentIndex = sections.indexOf(currentSection);
      const progress = (currentIndex / (sections.length - 1)) * 100;
      document.getElementById('progressBar').style.width = `${progress}%`;
    }
    
    // Helper function to update MathJax rendering.
    function updateMath() {
      if (window.MathJax && MathJax.typesetPromise) {
        MathJax.typesetPromise();
      }
    }

    // Get canvas contexts for drawing
    const areaCtx = document.getElementById('areaCanvas').getContext('2d');
    const riemannCtx = document.getElementById('riemannCanvas').getContext('2d');
    const definiteCtx = document.getElementById('definiteCanvas').getContext('2d');
    const indefiniteCtx = document.getElementById('indefiniteCanvas').getContext('2d');
    const ftcCtx = document.getElementById('ftcCanvas').getContext('2d');
    const areaBetweenCtx = document.getElementById('areaBetweenCanvas').getContext('2d');
    const volumeCtx = document.getElementById('volumeCanvas').getContext('2d');

    // Utility functions for coordinate transformation
    function transformX(x, canvas) {
      return canvas.width / 2 + x * 20;
    }
    function transformY(y, canvas) {
      return canvas.height / 2 - y * 20;
    }

    // Draw coordinate system on a given canvas context
    function drawCoordinateSystem(ctx) {
      const canvas = ctx.canvas;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      // Draw x-axis
      ctx.moveTo(0, canvas.height / 2);
      ctx.lineTo(canvas.width, canvas.height / 2);
      // Draw y-axis
      ctx.moveTo(canvas.width / 2, 0);
      ctx.lineTo(canvas.width / 2, canvas.height);
      ctx.strokeStyle = '#000';
      ctx.stroke();

      // Draw grid lines
      ctx.strokeStyle = '#ddd';
      ctx.beginPath();
      for (let x = -10; x <= 10; x++) {
        if (x === 0) continue;
        const screenX = transformX(x, canvas);
        ctx.moveTo(screenX, 0);
        ctx.lineTo(screenX, canvas.height);
      }
      for (let y = -7; y <= 7; y++) {
        if (y === 0) continue;
        const screenY = transformY(y, canvas);
        ctx.moveTo(0, screenY);
        ctx.lineTo(canvas.width, screenY);
      }
      ctx.stroke();
      
      // Label axes
      ctx.fillStyle = '#000';
      ctx.font = '12px Arial';
      ctx.fillText('x', canvas.width - 10, canvas.height / 2 - 10);
      ctx.fillText('y', canvas.width / 2 + 10, 10);
      
      // Add scale markers
      for (let x = -10; x <= 10; x += 2) {
        if (x === 0) continue;
        const screenX = transformX(x, canvas);
        ctx.fillText(x.toString(), screenX - 5, canvas.height / 2 + 15);
      }
      for (let y = -7; y <= 7; y += 2) {
        if (y === 0) continue;
        const screenY = transformY(y, canvas);
        ctx.fillText(y.toString(), canvas.width / 2 + 5, screenY + 5);
      }
    }

    // Function evaluator for different types
    function evaluateFunction(x, type) {
      switch(type) {
        case 'linear':
          return x;
        case 'quadratic':
          return x * x / 2;
        case 'sine':
          return Math.sin(x);
        case 'exponential':
          return Math.exp(x/2);
        case 'constant':
          return 2;
        default:
          return 0;
      }
    }

    // Antiderivative evaluator
    function evaluateAntiderivative(x, type) {
      switch(type) {
        case 'linear':
          return x * x / 2;
        case 'quadratic':
          return x * x * x / 6;
        case 'sine':
          return -Math.cos(x);
        case 'exponential':
          return 2 * Math.exp(x/2);
        case 'constant':
          return 2 * x;
        default:
          return 0;
      }
    }

    // AREA UNDER CURVE SECTION
    function updateArea() {
      const lower = parseFloat(document.getElementById('lowerAreaSlider').value);
      const upper = parseFloat(document.getElementById('upperAreaSlider').value);
      const functionType = document.getElementById('functionSelect').value;
      
      document.getElementById('lowerAreaValue').textContent = lower.toFixed(1);
      document.getElementById('upperAreaValue').textContent = upper.toFixed(1);
      document.getElementById('lowerAreaBound').textContent = lower.toFixed(1);
      document.getElementById('upperAreaBound').textContent = upper.toFixed(1);
      
      // Numerical integration
      const steps = 1000;
      const dx = (upper - lower) / steps;
      let area = 0;
      let negativeArea = 0;
      
      for (let i = 0; i < steps; i++) {
        const x = lower + i * dx;
        const y = evaluateFunction(x, functionType);
        if (y >= 0) {
          area += y * dx;
        } else {
          negativeArea += Math.abs(y) * dx;
        }
      }
      
      document.getElementById('areaValue').textContent = area.toFixed(3);
      document.getElementById('negativeAreaValue').textContent = negativeArea.toFixed(3);
      
      // Draw function and fill area under curve
      drawCoordinateSystem(areaCtx);
      areaCtx.beginPath();
      areaCtx.strokeStyle = '#007bff';
      areaCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = evaluateFunction(x, functionType);
        const screenX = transformX(x, areaCtx.canvas);
        const screenY = transformY(y, areaCtx.canvas);
        if (x === -10) {
          areaCtx.moveTo(screenX, screenY);
        } else {
          areaCtx.lineTo(screenX, screenY);
        }
      }
      areaCtx.stroke();
      
      // Fill positive area
      areaCtx.beginPath();
      areaCtx.moveTo(transformX(lower, areaCtx.canvas), transformY(0, areaCtx.canvas));
      for (let x = lower; x <= upper; x += 0.1) {
        const y = evaluateFunction(x, functionType);
        if (y >= 0) {
          areaCtx.lineTo(transformX(x, areaCtx.canvas), transformY(y, areaCtx.canvas));
        } else {
          areaCtx.lineTo(transformX(x, areaCtx.canvas), transformY(0, areaCtx.canvas));
        }
      }
      areaCtx.lineTo(transformX(upper, areaCtx.canvas), transformY(0, areaCtx.canvas));
      areaCtx.closePath();
      areaCtx.fillStyle = 'rgba(0, 123, 255, 0.2)';
      areaCtx.fill();
      
      // Fill negative area
      areaCtx.beginPath();
      areaCtx.moveTo(transformX(lower, areaCtx.canvas), transformY(0, areaCtx.canvas));
      for (let x = lower; x <= upper; x += 0.1) {
        const y = evaluateFunction(x, functionType);
        if (y < 0) {
          areaCtx.lineTo(transformX(x, areaCtx.canvas), transformY(y, areaCtx.canvas));
        } else {
          areaCtx.lineTo(transformX(x, areaCtx.canvas), transformY(0, areaCtx.canvas));
        }
      }
      areaCtx.lineTo(transformX(upper, areaCtx.canvas), transformY(0, areaCtx.canvas));
      areaCtx.closePath();
      areaCtx.fillStyle = 'rgba(255, 0, 0, 0.2)';
      areaCtx.fill();
      
      updateMath();
    }
    
    function toggleNegativeArea() {
      const negativeAreaInfo = document.getElementById('negativeAreaInfo');
      if (negativeAreaInfo.style.display === 'none') {
        negativeAreaInfo.style.display = 'block';
      } else {
        negativeAreaInfo.style.display = 'none';
      }
    }

    // RIEMANN SUMS SECTION
    function updateRiemann() {
      const rectCount = parseInt(document.getElementById('rectCountSlider').value);
      const riemannType = document.getElementById('riemannType').value;
      document.getElementById('rectCountValue').textContent = rectCount;
      document.getElementById('rectCount').textContent = rectCount;
      
      const lower = 0;
      const upper = 2;
      const dx = (upper - lower) / rectCount;
      let sum = 0;
      
      drawCoordinateSystem(riemannCtx);
      riemannCtx.beginPath();
      riemannCtx.strokeStyle = '#007bff';
      riemannCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = Math.pow(x, 2) / 2;
        const screenX = transformX(x, riemannCtx.canvas);
        const screenY = transformY(y, riemannCtx.canvas);
        if (x === -10) {
          riemannCtx.moveTo(screenX, screenY);
        } else {
          riemannCtx.lineTo(screenX, screenY);
        }
      }
      riemannCtx.stroke();
      
      riemannCtx.fillStyle = 'rgba(0, 123, 255, 0.2)';
      
      for (let i = 0; i < rectCount; i++) {
        let x, y;
        switch(riemannType) {
          case 'left':
            x = lower + i * dx;
            y = Math.pow(x, 2) / 2;
            break;
          case 'right':
            x = lower + (i + 1) * dx;
            y = Math.pow(x, 2) / 2;
            break;
          case 'middle':
            x = lower + (i + 0.5) * dx;
            y = Math.pow(x, 2) / 2;
            break;
          case 'trapezoidal':
            x = lower + i * dx;
            const y1 = Math.pow(x, 2) / 2;
            const y2 = Math.pow(x + dx, 2) / 2;
            y = (y1 + y2) / 2;
            break;
        }
        sum += y * dx;
        
        if (riemannType === 'trapezoidal') {
          riemannCtx.beginPath();
          riemannCtx.moveTo(transformX(lower + i * dx, riemannCtx.canvas), transformY(y1, riemannCtx.canvas));
          riemannCtx.lineTo(transformX(lower + (i + 1) * dx, riemannCtx.canvas), transformY(y2, riemannCtx.canvas));
          riemannCtx.lineTo(transformX(lower + (i + 1) * dx, riemannCtx.canvas), transformY(0, riemannCtx.canvas));
          riemannCtx.lineTo(transformX(lower + i * dx, riemannCtx.canvas), transformY(0, riemannCtx.canvas));
          riemannCtx.closePath();
          riemannCtx.fill();
        } else {
          riemannCtx.fillRect(
            transformX(lower + i * dx, riemannCtx.canvas),
            transformY(y, riemannCtx.canvas),
            dx * 20,
            transformY(0, riemannCtx.canvas) - transformY(y, riemannCtx.canvas)
          );
        }
      }
      
      const actualArea = Math.pow(upper, 3) / 6; // Because ∫₀² (x²/2)dx = (2³-0³)/6
      const error = Math.abs(actualArea - sum);
      const percentageError = (error / actualArea) * 100;
      
      document.getElementById('riemannValue').textContent = sum.toFixed(3);
      document.getElementById('actualArea').textContent = actualArea.toFixed(3);
      document.getElementById('errorValue').textContent = error.toFixed(3);
      document.getElementById('percentageError').textContent = percentageError.toFixed(1);
      
      updateMath();
    }
    
    let riemannAnimation;
    function animateRiemannConvergence() {
      let rectCount = 1;
      const maxRectCount = 100;
      if (riemannAnimation) { cancelAnimationFrame(riemannAnimation); }
      
      function animate() {
        document.getElementById('rectCountSlider').value = rectCount;
        updateRiemann();
        rectCount++;
        if (rectCount <= maxRectCount) {
          riemannAnimation = requestAnimationFrame(animate);
        }
      }
      animate();
    }

    // DEFINITE INTEGRALS SECTION
    let integrationAnimation;
    function animateIntegration() {
      const functionType = document.getElementById('definiteFunctionSelect').value;
      const lower = parseFloat(document.getElementById('lowerBoundSlider').value);
      const upper = parseFloat(document.getElementById('upperBoundSlider').value);
      let currentX = lower;
      
      document.getElementById('lowerBoundValue').textContent = lower.toFixed(1);
      document.getElementById('upperBoundValue').textContent = upper.toFixed(1);
      document.getElementById('lowerBound').textContent = lower.toFixed(1);
      document.getElementById('upperBound').textContent = upper.toFixed(1);
      
      if (integrationAnimation) { cancelAnimationFrame(integrationAnimation); }
      
      function animate() {
        drawCoordinateSystem(definiteCtx);
        definiteCtx.beginPath();
        definiteCtx.strokeStyle = '#007bff';
        definiteCtx.lineWidth = 2;
        for (let x = -10; x <= 10; x += 0.1) {
          const y = evaluateFunction(x, functionType);
          const screenX = transformX(x, definiteCtx.canvas);
          const screenY = transformY(y, definiteCtx.canvas);
          if (x === -10) {
            definiteCtx.moveTo(screenX, screenY);
          } else {
            definiteCtx.lineTo(screenX, screenY);
          }
        }
        definiteCtx.stroke();
        
        definiteCtx.beginPath();
        definiteCtx.moveTo(transformX(lower, definiteCtx.canvas), transformY(0, definiteCtx.canvas));
        for (let x = lower; x <= currentX; x += 0.1) {
          const y = evaluateFunction(x, functionType);
          definiteCtx.lineTo(transformX(x, definiteCtx.canvas), transformY(y, definiteCtx.canvas));
        }
        definiteCtx.lineTo(transformX(currentX, definiteCtx.canvas), transformY(0, definiteCtx.canvas));
        definiteCtx.closePath();
        definiteCtx.fillStyle = 'rgba(0, 123, 255, 0.2)';
        definiteCtx.fill();
        
        const integralValue = evaluateAntiderivative(currentX, functionType) - evaluateAntiderivative(lower, functionType);
        document.getElementById('integralValue').textContent = integralValue.toFixed(3);
        
        // Update antiderivative display
        let antiderivativeText;
        switch(functionType) {
          case 'linear':
            antiderivativeText = "\\frac{x^2}{2}";
            break;
          case 'quadratic':
            antiderivativeText = "\\frac{x^3}{6}";
            break;
          case 'sine':
            antiderivativeText = "-\\cos(x)";
            break;
          case 'exponential':
            antiderivativeText = "2e^{x/2}";
            break;
        }
        document.getElementById('antiderivativeDisplay').innerHTML = `\\( ${antiderivativeText} \\)`;
        document.getElementById('evaluationDisplay').innerHTML = 
          `\\( F(b) - F(a) = ${evaluateAntiderivative(currentX, functionType).toFixed(3)} - ${evaluateAntiderivative(lower, functionType).toFixed(3)} = ${integralValue.toFixed(3)} \\)`;
        
        currentX += (upper - currentX) * 0.05;
        if (Math.abs(currentX - upper) > 0.01) {
          integrationAnimation = requestAnimationFrame(animate);
        }
        updateMath();
      }
      animate();
    }
    
    function showAccumulationFunction() {
      const functionType = document.getElementById('definiteFunctionSelect').value;
      const lower = parseFloat(document.getElementById('lowerBoundSlider').value);
      
      drawCoordinateSystem(definiteCtx);
      
      // Draw original function
      definiteCtx.beginPath();
      definiteCtx.strokeStyle = '#007bff';
      definiteCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = evaluateFunction(x, functionType);
        const screenX = transformX(x, definiteCtx.canvas);
        const screenY = transformY(y, definiteCtx.canvas);
        if (x === -10) {
          definiteCtx.moveTo(screenX, screenY);
        } else {
          definiteCtx.lineTo(screenX, screenY);
        }
      }
      definiteCtx.stroke();
      
      // Draw accumulation function
      definiteCtx.beginPath();
      definiteCtx.strokeStyle = '#28a745';
      definiteCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = evaluateAntiderivative(x, functionType) - evaluateAntiderivative(lower, functionType);
        const screenX = transformX(x, definiteCtx.canvas);
        const screenY = transformY(y, definiteCtx.canvas);
        if (x === -10) {
          definiteCtx.moveTo(screenX, screenY);
        } else {
          definiteCtx.lineTo(screenX, screenY);
        }
      }
      definiteCtx.stroke();
      
      // Add legend
      definiteCtx.fillStyle = '#007bff';
      definiteCtx.fillText('f(x)', 20, 30);
      definiteCtx.fillStyle = '#28a745';
      definiteCtx.fillText("F(x) - F(a)", 20, 50);
      
      updateMath();
    }

    // INDEFINITE INTEGRALS SECTION
    function showAntiderivative() {
      const functionType = document.getElementById('indefiniteSelect').value;
      drawCoordinateSystem(indefiniteCtx);
      let originalFunc, antiderivativeFunc;
      switch(functionType) {
        case 'constant':
          originalFunc = "2";
          antiderivativeFunc = "2x + C";
          break;
        case 'linear':
          originalFunc = "2x";
          antiderivativeFunc = "x^2 + C";
          break;
        case 'quadratic':
          originalFunc = "x^2";
          antiderivativeFunc = "\\frac{x^3}{3} + C";
          break;
        case 'sine':
          originalFunc = "\\sin x";
          antiderivativeFunc = "-\\cos x + C";
          break;
        case 'exponential':
          originalFunc = "e^x";
          antiderivativeFunc = "e^x + C";
          break;
        case 'reciprocal':
          originalFunc = "\\frac{1}{x}";
          antiderivativeFunc = "\\ln|x| + C";
          break;
      }
      document.getElementById('originalFunction').innerHTML = `\\( ${originalFunc} \\)`;
      document.getElementById('antiderivative').innerHTML = `\\( ${antiderivativeFunc} \\)`;
      
      // Draw original function curve
      indefiniteCtx.beginPath();
      indefiniteCtx.strokeStyle = '#007bff';
      indefiniteCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        if (functionType === 'reciprocal' && x === 0) continue;
        const y = evaluateFunction(x, functionType);
        const screenX = transformX(x, indefiniteCtx.canvas);
        const screenY = transformY(y, indefiniteCtx.canvas);
        if (x === -10 || (functionType === 'reciprocal' && x < 0 && x + 0.1 >= 0)) {
          indefiniteCtx.moveTo(screenX, screenY);
        } else {
          indefiniteCtx.lineTo(screenX, screenY);
        }
      }
      indefiniteCtx.stroke();
      
      updateMath();
    }
    
    function showFamilyOfCurves() {
      const functionType = document.getElementById('indefiniteSelect').value;
      drawCoordinateSystem(indefiniteCtx);
      
      // Draw original function
      indefiniteCtx.beginPath();
      indefiniteCtx.strokeStyle = '#007bff';
      indefiniteCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        if (functionType === 'reciprocal' && x === 0) continue;
        const y = evaluateFunction(x, functionType);
        const screenX = transformX(x, indefiniteCtx.canvas);
        const screenY = transformY(y, indefiniteCtx.canvas);
        if (x === -10 || (functionType === 'reciprocal' && x < 0 && x + 0.1 >= 0)) {
          indefiniteCtx.moveTo(screenX, screenY);
        } else {
          indefiniteCtx.lineTo(screenX, screenY);
        }
      }
      indefiniteCtx.stroke();
      
      // Draw family of antiderivatives
      const colors = ['#28a745', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c'];
      for (let c = -2; c <= 2; c++) {
        indefiniteCtx.beginPath();
        indefiniteCtx.strokeStyle = colors[c + 2];
        indefiniteCtx.lineWidth = 1;
        for (let x = -10; x <= 10; x += 0.1) {
          if (functionType === 'reciprocal' && x === 0) continue;
          let y;
          switch(functionType) {
            case 'constant':
              y = 2 * x + c;
              break;
            case 'linear':
              y = x * x + c;
              break;
            case 'quadratic':
              y = Math.pow(x, 3) / 3 + c;
              break;
            case 'sine':
              y = -Math.cos(x) + c;
              break;
            case 'exponential':
              y = Math.exp(x) + c;
              break;
            case 'reciprocal':
              y = Math.log(Math.abs(x)) + c;
              break;
          }
          const screenX = transformX(x, indefiniteCtx.canvas);
          const screenY = transformY(y, indefiniteCtx.canvas);
          if (x === -10 || (functionType === 'reciprocal' && x < 0 && x + 0.1 >= 0)) {
            indefiniteCtx.moveTo(screenX, screenY);
          } else {
            indefiniteCtx.lineTo(screenX, screenY);
          }
        }
        indefiniteCtx.stroke();
      }
      
      // Add legend
      indefiniteCtx.fillStyle = '#007bff';
      indefiniteCtx.fillText('f(x)', 20, 30);
      indefiniteCtx.fillStyle = '#28a745';
      indefiniteCtx.fillText("Family of F(x) + C", 20, 50);
      
      updateMath();
    }

    // FUNDAMENTAL THEOREM OF CALCULUS SECTION
    function demonstrateFTC() {
      const functionType = document.getElementById('ftcFunctionSelect').value;
      const lower = parseFloat(document.getElementById('ftcLowerSlider').value);
      const upper = parseFloat(document.getElementById('ftcUpperSlider').value);
      
      document.getElementById('ftcLowerValue').textContent = lower.toFixed(1);
      document.getElementById('ftcUpperValue').textContent = upper.toFixed(1);
      document.getElementById('ftcLowerBound').textContent = lower.toFixed(1);
      document.getElementById('currentX').textContent = upper.toFixed(1);
      document.getElementById('currentX2').textContent = upper.toFixed(1);
      
      drawCoordinateSystem(ftcCtx);
      
      // Draw original function
      ftcCtx.beginPath();
      ftcCtx.strokeStyle = '#007bff';
      ftcCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = evaluateFunction(x, functionType);
        const screenX = transformX(x, ftcCtx.canvas);
        const screenY = transformY(y, ftcCtx.canvas);
        if (x === -10) {
          ftcCtx.moveTo(screenX, screenY);
        } else {
          ftcCtx.lineTo(screenX, screenY);
        }
      }
      ftcCtx.stroke();
      
      // Draw accumulation function
      ftcCtx.beginPath();
      ftcCtx.strokeStyle = '#28a745';
      ftcCtx.lineWidth = 2;
      for (let x = -10; x <= 10; x += 0.1) {
        const y = evaluateAntiderivative(x, functionType) - evaluateAntiderivative(lower, functionType);
        const screenX = transformX(x, ftcCtx.canvas);
        const screenY = transformY(y, ftcCtx.canvas);
        if (x === -10) {
          ftcCtx.moveTo(screenX, screenY);
        } else {
          ftcCtx.lineTo(screenX, screenY);
        }
      }
      ftcCtx.stroke();
      
      // Highlight the current point on both curves
      const funcValue = evaluateFunction(upper, functionType);
      const ftcValue = evaluateAntiderivative(upper, functionType) - evaluateAntiderivative(lower, functionType);
      
      ftcCtx.beginPath();
      ftcCtx.arc(transformX(upper, ftcCtx.canvas), transformY(funcValue, ftcCtx.canvas), 5, 0, Math.PI * 2);
      ftcCtx.fillStyle = '#007bff';
      ftcCtx.fill();
      
      ftcCtx.beginPath();
      ftcCtx.arc(transformX(upper, ftcCtx.canvas), transformY(ftcValue, ftcCtx.canvas), 5, 0, Math.PI * 2);
      ftcCtx.fillStyle = '#28a745';
      ftcCtx.fill();
      
      // Draw tangent line to accumulation function at the point
      const slope = evaluateFunction(upper, functionType);
      const tangentY1 = ftcValue - slope * 2;
      const tangentY2 = ftcValue + slope * 2;
      
      ftcCtx.beginPath();
      ftcCtx.strokeStyle = '#e74c3c';
      ftcCtx.lineWidth = 2;
      ftcCtx.moveTo(transformX(upper - 2, ftcCtx.canvas), transformY(tangentY1, ftcCtx.canvas));
      ftcCtx.lineTo(transformX(upper + 2, ftcCtx.canvas), transformY(tangentY2, ftcCtx.canvas));
      ftcCtx.stroke();
      
      // Update calculations
      document.getElementById('ftcValue').textContent = ftcValue.toFixed(3);
      document.getElementById('functionValue').textContent = funcValue.toFixed(3);
      
      let derivativeText;
      switch(functionType) {
        case 'linear':
          derivativeText = "x";
          break;
        case 'quadratic':
          derivativeText = "\\frac{x^2}{2}";
          break;
        case 'sine':
          derivativeText = "\\sin x";
          break;
      }
      document.getElementById('ftcDerivative').innerHTML = `\\( ${derivativeText} \\)`;
      
      updateMath();
    }

    // APPLICATIONS SECTION
    function showAreaBetweenCurves() {
      const curvesType = document.getElementById('areaBetweenSelect').value;
      drawCoordinateSystem(areaBetweenCtx);
      
      let f1, f2;
      switch(curvesType) {
        case 'linear_quadratic':
          f1 = x => x;
          f2 = x => x * x / 2;
          break;
        case 'sine_cosine':
          f1 = x => Math.sin(x);
          f2 = x => Math.cos(x);
          break;
        case 'exponential_linear':
          f1 = x => Math.exp(x/2);
          f2 = x => x;
          break;
      }
      
      // Draw both curves
      areaBetweenCtx.beginPath();
      areaBetweenCtx.strokeStyle = '#007bff';
      areaBetweenCtx.lineWidth = 2;
      for (let x = -5; x <= 5; x += 0.1) {
        const y = f1(x);
        const screenX = transformX(x, areaBetweenCtx.canvas);
        const screenY = transformY(y, areaBetweenCtx.canvas);
        if (x === -5) {
          areaBetweenCtx.moveTo(screenX, screenY);
        } else {
          areaBetweenCtx.lineTo(screenX, screenY);
        }
      }
      areaBetweenCtx.stroke();
      
      areaBetweenCtx.beginPath();
      areaBetweenCtx.strokeStyle = '#28a745';
      areaBetweenCtx.lineWidth = 2;
      for (let x = -5; x <= 5; x += 0.1) {
        const y = f2(x);
        const screenX = transformX(x, areaBetweenCtx.canvas);
        const screenY = transformY(y, areaBetweenCtx.canvas);
        if (x === -5) {
          areaBetweenCtx.moveTo(screenX, screenY);
        } else {
          areaBetweenCtx.lineTo(screenX, screenY);
        }
      }
      areaBetweenCtx.stroke();
      
      // Fill area between curves
      areaBetweenCtx.beginPath();
      for (let x = -2; x <= 2; x += 0.1) {
        const y1 = f1(x);
        const y2 = f2(x);
        const screenX = transformX(x, areaBetweenCtx.canvas);
        const screenY = y1 >= y2 ? transformY(y1, areaBetweenCtx.canvas) : transformY(y2, areaBetweenCtx.canvas);
        if (x === -2) {
          areaBetweenCtx.moveTo(screenX, screenY);
        } else {
          areaBetweenCtx.lineTo(screenX, screenY);
        }
      }
      for (let x = 2; x >= -2; x -= 0.1) {
        const y1 = f1(x);
        const y2 = f2(x);
        const screenX = transformX(x, areaBetweenCtx.canvas);
        const screenY = y1 >= y2 ? transformY(y2, areaBetweenCtx.canvas) : transformY(y1, areaBetweenCtx.canvas);
        areaBetweenCtx.lineTo(screenX, screenY);
      }
      areaBetweenCtx.closePath();
      areaBetweenCtx.fillStyle = 'rgba(0, 123, 255, 0.2)';
      areaBetweenCtx.fill();
      
      // Add legend
      areaBetweenCtx.fillStyle = '#007bff';
      areaBetweenCtx.fillText('f(x)', 20, 30);
      areaBetweenCtx.fillStyle = '#28a745';
      areaBetweenCtx.fillText("g(x)", 20, 50);
      areaBetweenCtx.fillStyle = '#007bff';
      areaBetweenCtx.fillText("Area between curves", 20, 70);
    }
    
    function showVolumeOfRevolution() {
      const volumeType = document.getElementById('volumeSelect').value;
      drawCoordinateSystem(volumeCtx);
      
      let f, axis;
      switch(volumeType) {
        case 'quadratic_x':
          f = x => x * x / 2;
          axis = 'x';
          break;
        case 'sine_x':
          f = x => Math.sin(x) + 1;
          axis = 'x';
          break;
        case 'linear_y':
          f = x => x;
          axis = 'y';
          break;
      }
      
      // Draw the curve
      volumeCtx.beginPath();
      volumeCtx.strokeStyle = '#007bff';
      volumeCtx.lineWidth = 2;
      for (let x = -5; x <= 5; x += 0.1) {
        const y = f(x);
        const screenX = transformX(x, volumeCtx.canvas);
        const screenY = transformY(y, volumeCtx.canvas);
        if (x === -5) {
          volumeCtx.moveTo(screenX, screenY);
        } else {
          volumeCtx.lineTo(screenX, screenY);
        }
      }
      volumeCtx.stroke();
      
      // Draw sample disks/washers
      volumeCtx.fillStyle = 'rgba(0, 123, 255, 0.1)';
      volumeCtx.strokeStyle = 'rgba(0, 123, 255, 0.3)';
      
      if (axis === 'x') {
        for (let x = 0; x <= 2; x += 0.2) {
          const y = f(x);
          const radius = y * 10; // Scale for visualization
          
          volumeCtx.beginPath();
          volumeCtx.ellipse(
            transformX(x, volumeCtx.canvas),
            transformY(0, volumeCtx.canvas),
            radius,
            radius / 2, // Flatten ellipses to show perspective
            0, 0, Math.PI * 2
          );
          volumeCtx.fill();
          volumeCtx.stroke();
        }
      } else {
        // Rotation about y-axis
        for (let y = 0; y <= 2; y += 0.2) {
          const x = f(y); // Since we're rotating about y-axis, we need x = f(y)
          const radius = x * 10; // Scale for visualization
          
          volumeCtx.beginPath();
          volumeCtx.ellipse(
            transformX(0, volumeCtx.canvas),
            transformY(y, volumeCtx.canvas),
            radius / 2, // Flatten ellipses to show perspective
            radius,
            Math.PI / 2, 0, Math.PI * 2
          );
          volumeCtx.fill();
          volumeCtx.stroke();
        }
      }
      
      // Add legend
      volumeCtx.fillStyle = '#007bff';
      volumeCtx.fillText('f(x)', 20, 30);
      volumeCtx.fillText("Sample disks", 20, 50);
    }
    
    function showPhysicsApplication() {
      const applicationType = document.getElementById('physicsSelect').value;
      let applicationHTML = '';
      
      switch(applicationType) {
        case 'spring':
          applicationHTML = `
            <p><strong>Spring Work:</strong> The work required to stretch a spring from position a to b is given by:</p>
            <div class="formula">\( W = \int_{a}^{b} kx\,dx \)</div>
            <p>where k is the spring constant.</p>
            <p><strong>Example:</strong> If k = 5 N/m, work to stretch from 0 to 2 m is:</p>
            <div class="formula">\( W = \int_{0}^{2} 5x\,dx = \left[ \frac{5x^2}{2} \right]_0^2 = 10 \) Joules</div>
          `;
          break;
        case 'pumping':
          applicationHTML = `
            <p><strong>Pumping Liquid:</strong> The work required to pump liquid from a tank is given by:</p>
            <div class="formula">\( W = \int_{a}^{b} \rho g A(y) (h - y)\,dy \)</div>
            <p>where:</p>
            <ul>
              <li>ρ is the density of the liquid</li>
              <li>g is the acceleration due to gravity</li>
              <li>A(y) is the cross-sectional area at height y</li>
              <li>h is the total height the liquid is pumped</li>
            </ul>
            <p><strong>Example:</strong> For a cylindrical tank of radius 2 m and height 10 m filled with water (ρ = 1000 kg/m³), the work to pump all the water to the top is:</p>
            <div class="formula">\( W = \int_{0}^{10} 1000 \cdot 9.8 \cdot \pi \cdot 2^2 \cdot (10 - y)\,dy \approx 6.16 \times 10^6 \) Joules</div>
          `;
          break;
        case 'fluid_pressure':
          applicationHTML = `
            <p><strong>Fluid Pressure:</strong> The force exerted by a fluid on a surface is given by:</p>
            <div class="formula">\( F = \int_{a}^{b} \rho g d(y) L(y)\,dy \)</div>
            <p>where:</p>
            <ul>
              <li>ρ is the density of the fluid</li>
              <li>g is the acceleration due to gravity</li>
              <li>d(y) is the depth at position y</li>
              <li>L(y) is the length of the surface at depth y</li>
            </ul>
            <p><strong>Example:</strong> For a rectangular dam 20 m wide and 10 m deep, the force on the dam when the water is at the top is:</p>
            <div class="formula">\( F = \int_{0}^{10} 1000 \cdot 9.8 \cdot y \cdot 20\,dy = 9.8 \times 10^6 \) Newtons</div>
          `;
          break;
      }
      
      document.getElementById('physicsApplication').innerHTML = applicationHTML;
      updateMath();
    }

    // Navigation function to switch between sections
    function showConcept(conceptId) {
      document.querySelectorAll('.concept').forEach(el => {
        el.classList.remove('active');
      });
      document.getElementById(conceptId).classList.add('active');
      updateProgressBar();
      
      switch(conceptId) {
        case 'introduction':
          // No special initialization needed
          break;
        case 'area':
          updateArea();
          break;
        case 'riemann':
          updateRiemann();
          break;
        case 'definite':
          drawCoordinateSystem(definiteCtx);
          break;
        case 'indefinite':
          showAntiderivative();
          break;
        case 'fundamental':
          demonstrateFTC();
          break;
        case 'applications':
          showAreaBetweenCurves();
          showVolumeOfRevolution();
          showPhysicsApplication();
          break;
        case 'practice':
          displayCurrentProblem();
          break;
      }
    }

    // Practice Problems Section
    const problemSets = {
      area: [
        {
          question: "Find the area under \\( y = x \\) from \\( x = 0 \\) to \\( x = 2 \\).",
          answer: 2,
          solution: "Area = \\( \\int_0^2 x\\,dx = \\left[ \\frac{x^2}{2} \\right]_0^2 = \\frac{4}{2} = 2 \\)",
          hint: "The antiderivative of x is x²/2"
        },
        {
          question: "Find the area under \\( y = x^2 \\) from \\( x = 0 \\) to \\( x = 1 \\).",
          answer: 0.333,
          solution: "Area = \\( \\int_0^1 x^2\\,dx = \\left[ \\frac{x^3}{3} \\right]_0^1 = \\frac{1}{3} \\approx 0.333 \\)",
          hint: "The antiderivative of x² is x³/3"
        },
        {
          question: "Find the area under \\( y = \\sin(x) \\) from \\( x = 0 \\) to \\( x = \\pi \\).",
          answer: 2,
          solution: "Area = \\( \\int_0^\\pi \\sin(x)\\,dx = [-\\cos(x)]_0^\\pi = (-(-1)) - (-1) = 2 \\)",
          hint: "The antiderivative of sin(x) is -cos(x)"
        }
      ],
      riemann: [
        {
          question: "Using 4 rectangles and left endpoints, approximate the area under \\( y = x^2 \\) from \\( x = 0 \\) to \\( x = 2 \\).",
          answer: 2.5,
          solution: "Width = 0.5; heights at \\( x = 0, 0.5, 1, 1.5 \\): \\( 0, 0.25, 1, 2.25 \\). Sum = \\( 0.5 \\times (0+0.25+1+2.25) = 2.5 \\)",
          hint: "Divide the interval into 4 equal parts and use the left endpoints"
        },
        {
          question: "Using 4 rectangles and right endpoints, approximate the area under \\( y = x \\) from \\( x = 0 \\) to \\( x = 2 \\).",
          answer: 2.5,
          solution: "Width = 0.5; heights at \\( x = 0.5, 1, 1.5, 2 \\): \\( 0.5, 1, 1.5, 2 \\). Sum = \\( 0.5 \\times (0.5+1+1.5+2) = 2.5 \\)",
          hint: "Divide the interval into 4 equal parts and use the right endpoints"
        },
        {
          question: "Using 6 rectangles and middle endpoints, approximate the area under \\( y = \\sin(x) \\) from \\( x = 0 \\) to \\( x = \\pi \\).",
          answer: 2,
          solution: "Using midpoints with 6 rectangles yields an approximate area of 2.",
          hint: "Divide the interval into 6 equal parts and use the midpoints"
        }
      ],
      definite: [
        {
          question: "Evaluate \\( \\int_0^2 (2x+1)\\,dx \\).",
          answer: 6,
          solution: "Antiderivative: \\( x^2 + x \\). Evaluated from 0 to 2: \\( (4+2) - 0 = 6 \\)",
          hint: "Find the antiderivative of each term separately"
        },
        {
          question: "Evaluate \\( \\int_1^2 (x^2 - x)\\,dx \\).",
          answer: 0.833,
          solution: "Antiderivative: \\( \\frac{x^3}{3} - \\frac{x^2}{2} \\). Evaluated from 1 to 2 gives approximately 0.833.",
          hint: "The antiderivative of x² is x³/3 and of x is x²/2"
        },
        {
          question: "Evaluate \\( \\int_0^1 (3x^2 - 2x + 1)\\,dx \\).",
          answer: 1,
          solution: "Antiderivative: \\( x^3 - x^2 + x \\). Evaluated from 0 to 1: \\( 1 - 1 + 1 = 1 \\)",
          hint: "Integrate each term separately"
        }
      ],
      indefinite: [
        {
          question: "Find \\( \\int (3x^2+2x)\\,dx \\).",
          answer: "x^3 + x^2 + C",
          solution: "Antiderivatives: \\( \\int 3x^2dx = x^3 \\) and \\( \\int 2xdx = x^2 \\). Hence, \\( x^3 + x^2 + C \\)",
          hint: "Use the power rule for integration"
        },
        {
          question: "Find \\( \\int (\\sin x + e^x)\\,dx \\).",
          answer: "-\\cos x + e^x + C",
          solution: "Since \\( \\int \\sin xdx = -\\cos x \\) and \\( \\int e^xdx = e^x \\), the answer is \\( -\\cos x + e^x + C \\)",
          hint: "Remember the antiderivatives of basic functions"
        },
        {
          question: "Find \\( \\int \\cos x\\,dx \\).",
          answer: "\\sin x + C",
          solution: "The antiderivative of \\( \\cos x \\) is \\( \\sin x + C \\)",
          hint: "The derivative of sin(x) is cos(x)"
        },
        {
          question: "Find \\( \\int (2x+3)\\,dx \\).",
          answer: "x^2 + 3x + C",
          solution: "Antiderivatives: \\( \\int 2xdx = x^2 \\) and \\( \\int 3dx = 3x \\). So, \\( x^2 + 3x + C \\)",
          hint: "Integrate each term separately"
        }
      ],
      applications: [
        {
          question: "Find the area between \\( y = x \\) and \\( y = x^2 \\) from \\( x = 0 \\) to \\( x = 1 \\).",
          answer: 0.167,
          solution: "Area = \\( \\int_0^1 (x - x^2)\\,dx = \\left[ \\frac{x^2}{2} - \\frac{x^3}{3} \\right]_0^1 = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6} \\approx 0.167 \\)",
          hint: "Subtract the lower function from the upper function before integrating"
        },
        {
          question: "Find the volume of the solid formed by rotating \\( y = \\sqrt{x} \\) from \\( x = 0 \\) to \\( x = 4 \\) about the x-axis.",
          answer: 8,
          solution: "Volume = \\( \\pi \\int_0^4 (\\sqrt{x})^2\\,dx = \\pi \\int_0^4 x\\,dx = \\pi \\left[ \\frac{x^2}{2} \\right]_0^4 = \\pi \\cdot 8 = 8\\pi \\)",
          hint: "Use the disk method: V = π∫[f(x)]²dx"
        },
        {
          question: "A spring requires 10 J of work to stretch from its natural length of 20 cm to 30 cm. How much work is needed to stretch it from 30 cm to 40 cm?",
          answer: 30,
          solution: "Using Hooke's Law: W = ∫kx dx = k(x²/2). For the first stretch: 10 = k(0.1²/2) = k(0.005) → k = 2000 N/m. For the second stretch: W = 2000∫_{0.1}^{0.2} x dx = 2000(0.02) = 40 J",
          hint: "Use the work formula for springs: W = ∫kx dx"
        }
      ]
    };

    let currentProblemType = 'area';
    let currentProblemIndex = 0;

    function changeProblemType(type) {
      currentProblemType = type;
      currentProblemIndex = 0;
      displayCurrentProblem();
      document.getElementById('problemTitle').textContent = type.charAt(0).toUpperCase() + type.slice(1) + ' Problems';
      document.getElementById('hint').style.display = 'none';
      document.getElementById('feedback').style.display = 'none';
      document.getElementById('solution').style.display = 'none';
    }

    function displayCurrentProblem() {
      const problem = problemSets[currentProblemType][currentProblemIndex];
      document.getElementById('currentProblem').innerHTML = problem.question;
      document.getElementById('feedback').style.display = 'none';
      document.getElementById('solution').style.display = 'none';
      document.getElementById('hint').style.display = 'none';
      document.getElementById('userAnswer').value = '';
      updateMath();
    }

    function checkAnswer() {
      const userAnswer = document.getElementById('userAnswer').value;
      const problem = problemSets[currentProblemType][currentProblemIndex];
      const feedback = document.getElementById('feedback');
      const isCorrect = typeof problem.answer === 'number'
        ? Math.abs(parseFloat(userAnswer) - problem.answer) < 0.1
        : userAnswer.toLowerCase().replace(/\s+/g, '') === problem.answer.toLowerCase().replace(/\s+/g, '');
      feedback.style.display = 'block';
      feedback.innerHTML = isCorrect 
        ? '<span style="color: green">Correct! Well done!</span>' 
        : '<span style="color: red">Not quite right. Try again or view the solution.</span>';
      updateMath();
    }

    function showSolution() {
      const solution = document.getElementById('solution');
      solution.style.display = 'block';
      solution.textContent = problemSets[currentProblemType][currentProblemIndex].solution;
      updateMath();
    }
    
    function hint() {
      const hint = document.getElementById('hint');
      hint.style.display = 'block';
      hint.textContent = "Hint: " + problemSets[currentProblemType][currentProblemIndex].hint;
    }

    function nextProblem() {
      currentProblemIndex = (currentProblemIndex + 1) % problemSets[currentProblemType].length;
      displayCurrentProblem();
    }

    // Event listeners for real-time slider updates
    document.getElementById('lowerAreaSlider').addEventListener('input', updateArea);
    document.getElementById('upperAreaSlider').addEventListener('input', updateArea);
    document.getElementById('functionSelect').addEventListener('change', updateArea);
    document.getElementById('rectCountSlider').addEventListener('input', updateRiemann);
    document.getElementById('riemannType').addEventListener('change', updateRiemann);
    document.getElementById('definiteFunctionSelect').addEventListener('change', () => {
      drawCoordinateSystem(definiteCtx);
    });
    document.getElementById('lowerBoundSlider').addEventListener('input', () => {
      const value = parseFloat(document.getElementById('lowerBoundSlider').value);
      document.getElementById('lowerBoundValue').textContent = value.toFixed(1);
      document.getElementById('lowerBound').textContent = value.toFixed(1);
    });
    document.getElementById('upperBoundSlider').addEventListener('input', () => {
      const value = parseFloat(document.getElementById('upperBoundSlider').value);
      document.getElementById('upperBoundValue').textContent = value.toFixed(1);
      document.getElementById('upperBound').textContent = value.toFixed(1);
    });
    document.getElementById('indefiniteSelect').addEventListener('change', showAntiderivative);
    document.getElementById('ftcFunctionSelect').addEventListener('change', demonstrateFTC);
    document.getElementById('ftcLowerSlider').addEventListener('input', demonstrateFTC);
    document.getElementById('ftcUpperSlider').addEventListener('input', demonstrateFTC);

    // Initialize all sections
    updateProgressBar();
    updateArea();
    updateRiemann();
    drawCoordinateSystem(definiteCtx);
    showAntiderivative();
    demonstrateFTC();
    showAreaBetweenCurves();
    showVolumeOfRevolution();
    showPhysicsApplication();
    displayCurrentProblem();
  </script>
</body>
</html>
